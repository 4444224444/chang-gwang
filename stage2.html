 <!DOCTYPE html>
  <html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="stage2.css">

  </head>
  <body>
     <div class="dark-mask"></div>
     <div id="highlight"></div>


     <div id="introOverlay">
  <div class="intro-text">第二章</div>
</div>




<div id="mainUI">
     <div id="message"></div>
    <div id="timeBarContainer">
        <div id="timeBar"></div>
        </div>

      <div class="BtnContainer">
    <button class="Btn" id="StartBtn">시작</button>
    <button class="Btn" id="GameExplanationBtn">설명</button>
      </div>
</div>

<div class="modal" id="modal">
    <p id="modalText"></p>
    <button class="btn-close" id="closeBtn">x</button>
</div>

  <button id="suspectBtn">이건 이상하지 않나요?</button>
</div>
  



<div id="awakeningOverlay" style="display: none;">
  <div id="awakeningText">
    <p>당신은 관찰당해 왔습니다.</p>
    <p>이건 신이 아닙니다.</p>
    <p>깨달았다면, 지금 도망치세요.</p>
    <div class="choiceButtons">
      <button id="escapeBtn">[ 깨닫는다 ]</button>
      <button id="ignoreBtn">[ 무시한다 ]</button>
    </div>
  </div>
</div>

  <script>
    let StartBtn = document.querySelector('#StartBtn');
    let isStartClickable = true;
    let GameExplanationBtn = document.querySelector('#GameExplanationBtn');

    let message = document.getElementById('message');
    let modal = document.getElementById('modal');
    let modalText = document.getElementById('modalText');
    let closeBtn = document.getElementById('closeBtn');

    let activeImages = 0;
    let timer = null;

  StartBtn.addEventListener('click', () => {
  if (!isStartClickable) return;
  isStartClickable = false;

  message.innerText = "";
  clearTimeout(timer);
  activeImages = 0;
  let imgs = [];

  // ⏰ 타이머바 초기화
  const timeBar = document.getElementById('timeBar');
  let totalTime = 15;
  let remainingTime = totalTime;
  timeBar.style.width = '100%';

  // 기존 이미지 랜덤 배치
  for (let i = 0; i < 5; i++) {
    let img = document.createElement('img');
    img.src = 'assets/images/foot.png';
    img.style.position = "absolute";

    let x = Math.floor(Math.random() * (window.innerWidth - 150));
    let y = Math.floor(Math.random() * (window.innerHeight - 150));

    img.style.left = `${x}px`;
    img.style.top = `${y}px`;

    let click = 0;
    let opacity = 1;
    activeImages++;

    img.addEventListener('click', () => {
      click++;
      opacity -= 0.1;
      img.style.opacity = opacity;

      if (click >= 10) {
        img.remove();
        activeImages--;
        if (activeImages === 0) {
          clearInterval(interval);
          timeBar.style.width = '0%';
          if (!blockMessage) message.innerText = "성공메세지";
        }
      }
    });

    document.body.appendChild(img);
    imgs.push(img);
  }

  // ⏳ 타임바 애니메이션
interval = setInterval(() => {
  if (remainingTime > 0) {
    remainingTime--;
    timeBar.style.width = `${(remainingTime / totalTime) * 100}%`;
  } else {
    clearInterval(interval);
    imgs.forEach(img => img.remove());
    timeBar.style.width = '0%';
    activeImages = 0;

    // 🔥 blockMessage 무시하고 무조건 메세지 띄움
    if (!document.getElementById('awakeningOverlay').style.display.includes('flex')) {
      message.innerText = "다시신앙심쌓으라는메세지";
      message.style.display = 'block'; // 혹시 숨겨져 있을 수도 있으니 강제로 표시
    }
  }
}, 1000);
});



    GameExplanationBtn.addEventListener('click', () => {
      modal.classList.add('active');
      modalText.textContent = '창광 게임 설명';
    });

    closeBtn.addEventListener('click', () => {
      modal.classList.remove('active');
    });

     const highlight = document.getElementById('highlight');
document.addEventListener('mousemove', (e) => {
  highlight.style.left = `${e.pageX}px`;
  highlight.style.top = `${e.pageY}px`;
});

window.onload = () => {
  // 인트로만 먼저 보여주고 UI 숨기기
  document.getElementById("mainUI").style.display = "none";

  // 3초 후 인트로 제거 + 전체 UI 보이게
  setTimeout(() => {
    document.getElementById("introOverlay").style.display = "none";
    document.getElementById("mainUI").style.display = "block";

    // 만약 효과 주고 싶다면 여기서 페이드 인 넣어도 됨
  }, 3000);
};

suspectBtn.addEventListener('click', () => {
  blockMessage = true;
  suspectBtn.style.display = 'none';

  const targets = [
    document.getElementById('StartBtn'),
    document.getElementById('GameExplanationBtn'),
    document.getElementById('message'),
    ...document.querySelectorAll('img'),
  ];

  targets.forEach((el, i) => {
    setTimeout(() => {
      if (el) {
        el.style.transition = 'all 0.8s ease';
        el.style.opacity = '0';
        el.style.transform = 'scale(1.3)';
        setTimeout(() => {
          el.style.display = 'none';
        }, 800);
      }
    }, i * 300);
  });

  // 필터 및 깨달음 연출
  setTimeout(() => {
    document.body.style.filter = 'contrast(2) grayscale(1) blur(1px)';
    document.body.style.transition = '0.8s ease';

    // 깨달음 텍스트 등장
    document.getElementById('awakeningOverlay').style.display = 'flex';
  }, targets.length * 300 + 1000);
});

document.getElementById('ignoreBtn').addEventListener('click', () => {
  alert("신앙심을 다시 다잡았습니다.");
  window.location.href = 'stage2.html'; // ← 너가 원하는 경로로 수정 가능
});

document.getElementById('escapeBtn').addEventListener('click', () => {
  alert("깨달았다면 도망가세요! 기회는 한 번입니다!");
  window.location.href = 'escape.html'; // ← 너가 원하는 경로로 수정 가능
});
  </script>



  </body>
  </html>


